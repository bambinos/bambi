<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Changelog – Bambi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./logos/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-24b2bc59dfb44dcacae2ef3892b980b7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./logos/RGB/Bambi_logo.png" alt="bambi-home" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./notebooks/getting_started.html"> 
<span class="menu-text">Getting Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./api/index.html"> 
<span class="menu-text">API Reference</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./notebooks/index.html"> 
<span class="menu-text">Examples</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./changelog.html" aria-current="page"> 
<span class="menu-text">Changelog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/bambinos/bambi" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="changelog" class="level1">
<h1>Changelog</h1>
<section id="x.x" class="level2">
<h2 class="anchored" data-anchor-id="x.x">0.X.X</h2>
<section id="new-features" class="level3">
<h3 class="anchored" data-anchor-id="new-features">New features</h3>
</section>
<section id="maintenance-and-fixes" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes">Maintenance and fixes</h3>
</section>
<section id="documentation" class="level3">
<h3 class="anchored" data-anchor-id="documentation">Documentation</h3>
</section>
<section id="deprecation" class="level3">
<h3 class="anchored" data-anchor-id="deprecation">Deprecation</h3>
</section>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">0.15.0</h2>
<section id="new-features-1" class="level3">
<h3 class="anchored" data-anchor-id="new-features-1">New features</h3>
<ul>
<li>Add default priors for binomial and bernoulli families with logit link (#830)</li>
<li>Add horseshoe prior (#836)</li>
<li>Handle multivariate responses with HSGP (#856)</li>
</ul>
</section>
<section id="maintenance-and-fixes-1" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-1">Maintenance and fixes</h3>
<ul>
<li>Change the JAX random number generator key for 32 bit systems (#833)</li>
<li>Change <code>rename</code> to <code>replace</code> in <code>pre-render.py</code> (#843)</li>
<li>Fix out of sample prediction for multivariate families. It would not work for tables where the number of rows was different from the one used to fit the model (#847)</li>
<li>Check variables before trying to access them in posterior predictive sampling (#851)</li>
<li>Pass kwargs to nutpie + create env.yml file (#855)</li>
</ul>
</section>
<section id="documentation-1" class="level3">
<h3 class="anchored" data-anchor-id="documentation-1">Documentation</h3>
<ul>
<li>Fix typos and incomplete doc strings (#765)</li>
<li>Clarify elpd differences interepretation (#825)</li>
<li>Fix the contributing readme link (#837)</li>
<li>Add example using <code>offset</code> (#842)</li>
<li>Fix model formula in negative binomial notebook (#859)</li>
<li>Fix formatting in t-test examples (#861)</li>
<li>Fix issue 812 Broken link (#862)</li>
<li>Update repository documentation files (#865)</li>
</ul>
</section>
<section id="deprecation-1" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-1">Deprecation</h3>
</section>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">0.14.0</h2>
<section id="new-features-2" class="level3">
<h3 class="anchored" data-anchor-id="new-features-2">New features</h3>
<ul>
<li>Add configuration facilities to Bambi (#745)</li>
<li>Interpet submodule now outputs informative messages when computing default values (#745)</li>
<li>Bambi supports weighted responses (#761)</li>
<li>Bambi supports constrained responses (#764)</li>
<li>Implement <code>compute_log_likelihood()</code> method to compute the log likelihood on a model (#769)</li>
<li>Add a class <code>InferenceMethods</code> that allows users to access the available inference methods and kwargs (#795)</li>
</ul>
</section>
<section id="maintenance-and-fixes-2" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-2">Maintenance and fixes</h3>
<ul>
<li>Fix bug in predictions with models using HSGP (#780)</li>
<li>Fix <code>get_model_covariates()</code> utility function (#801)</li>
<li>Upgrade PyMC dependency to &gt;= 5.13 (#803)</li>
<li>Use <code>pm.compute_deterministics()</code> to compute deterministics when bayeux based samplers are used (#803)</li>
<li>Wrap all the parameters of the response distribution (the likelihood) with a <code>pm.Deterministic</code> (#804)</li>
<li>Keep <code>bayeux-ml</code> as the single direct JAX-related dependency (#804)</li>
<li>The response component only holds response information about the response, not about predictors of the parent parameter (#804)</li>
<li>Resolve import error associated with bayeux (#822)</li>
</ul>
</section>
<section id="documentation-2" class="level3">
<h3 class="anchored" data-anchor-id="documentation-2">Documentation</h3>
<ul>
<li>Our Code of Conduct now includes how to send a report (#783)</li>
<li>Add polynomial regression example (#809)</li>
<li>Add Contact form to our webpage (#816)</li>
</ul>
</section>
<section id="deprecation-2" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-2">Deprecation</h3>
<ul>
<li><code>f"{response_name}_obs"</code> has been replaced by <code>"__obs__"</code> as the dimension name for the observation index (#804)</li>
<li><code>f"{response_name}_{parameter_name}"</code> is no longer the name for the name of parameters of the likelihood. Now Bambi uses <code>"{parameter_name}"</code> (#804)</li>
<li><code>kind</code> in <code>Model.predict()</code> now use <code>"response_params"</code> and <code>"response"</code> instead of <code>"mean"</code> and <code>"pps"</code> (#804)</li>
<li><code>include_mean</code> has been replaced by <code>include_response_params</code> in <code>Model.fit()</code> (#804)</li>
</ul>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">0.13.0</h2>
<p>This is the first version of Bambi that is released with a Governance structure. Added in #709.</p>
<section id="new-features-3" class="level3">
<h3 class="anchored" data-anchor-id="new-features-3">New features</h3>
<ul>
<li>Bambi now supports censored responses (#697)</li>
<li>Implement <code>"exponential"</code> and <code>"weibull"</code> families (#697)</li>
<li>Add <code>"kidney"</code> dataset (#697)</li>
<li>Add <code>interpret</code> submodule (#684, #695, #699, #701, #732, #736)
<ul>
<li>Implements <code>comparisons</code>, <code>predictions</code>, <code>slopes</code>, <code>plot_comparisons</code>, <code>plot_predictions</code>, and <code>plot_slopes</code></li>
</ul></li>
<li>Support censored families</li>
</ul>
</section>
<section id="maintenance-and-fixes-3" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-3">Maintenance and fixes</h3>
<ul>
<li>Bump <code>quartodoc</code> version to 0.6.1 (#720)</li>
<li>Replace <code>univariate_ordered</code> with <code>ordered</code> (#724)</li>
<li>Add missing docstring for <code>center_predictors</code> (#726)</li>
<li>Fix bugs in <code>plot_comparison</code> (#731)</li>
</ul>
</section>
<section id="documentation-3" class="level3">
<h3 class="anchored" data-anchor-id="documentation-3">Documentation</h3>
<ul>
<li>Add docstrings to utility functions (#696)</li>
<li>Migrate documentation to Quarto (#712)</li>
<li>Add case study for MRP (#716)</li>
<li>Add example about ordinal regression (#719)</li>
<li>Add example about zero inflated models (#725)</li>
<li>Add example about predictions for new groups (#734)</li>
</ul>
</section>
<section id="deprecation-3" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-3">Deprecation</h3>
<ul>
<li>Drop official suport for Python 3.8 (#720)</li>
<li>Change <code>plots</code> submodule name to <code>interpret</code> (#705)</li>
</ul>
</section>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">0.12.0</h2>
<section id="new-features-4" class="level3">
<h3 class="anchored" data-anchor-id="new-features-4">New features</h3>
<ul>
<li>Implement new families <code>"ordinal"</code> and <code>"sratio"</code> for modeling of ordinal responses (#678)</li>
<li>Allow families to implement a custom <code>create_extra_pps_coord()</code> (#688)</li>
<li>Allow predictions on new groups (#693)</li>
</ul>
</section>
<section id="maintenance-and-fixes-4" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-4">Maintenance and fixes</h3>
<ul>
<li>Robustify how Bambi handles dims (#682)</li>
<li>Fix links in FAQ (#686)</li>
<li>Update additional dependencies install command (#689)</li>
<li>Update predict pps docstring (#690)</li>
<li>Add warning for aliases athat aren’t used (#691)</li>
</ul>
</section>
<section id="documentation-4" class="level3">
<h3 class="anchored" data-anchor-id="documentation-4">Documentation</h3>
<ul>
<li>Add families to the Getting Started guide (#683)</li>
</ul>
</section>
<section id="deprecation-4" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-4">Deprecation</h3>
</section>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">0.11.0</h2>
<section id="new-features-5" class="level3">
<h3 class="anchored" data-anchor-id="new-features-5">New features</h3>
<ul>
<li>Add support for Gaussian Processes via the HSGP approximation (#632)</li>
<li>Add new families: <code>"zero_inflated_poisson"</code>, <code>"zero_inflated_binomial"</code>, and <code>"zero_inflated_negativebinomial"</code> (#654)</li>
<li>Add new families: <code>"beta_binomial"</code> and <code>"dirichlet_multinomial"</code> (#659)</li>
<li>Allow <code>plot_cap()</code> to show predictions at the observation level (#668)</li>
<li>Add new families: <code>"hurdle_gamma"</code>, <code>"hurdle_lognormal"</code>, <code>"hurdle_negativebinomial"</code>, and <code>"hurdle_poisson"</code> (#676)</li>
</ul>
</section>
<section id="maintenance-and-fixes-5" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-5">Maintenance and fixes</h3>
<ul>
<li>Modify how HSGP is built in PyMC when there are groups (#661)</li>
<li>Modify how Bambi is imported in the tests (#662)</li>
<li>Prevent underscores from being removed in dim names (#664)</li>
<li>Bump sphix dependency to a version greater than 7 (#672)</li>
</ul>
</section>
<section id="documentation-5" class="level3">
<h3 class="anchored" data-anchor-id="documentation-5">Documentation</h3>
<ul>
<li>Document how to use custom priors (#656)</li>
<li>Fix name of arviz traceplot function in the docs (#666)</li>
<li>Add example that shows how <code>plot_cap()</code> works (#670)</li>
</ul>
</section>
<section id="deprecation-5" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-5">Deprecation</h3>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">0.10.0</h2>
<section id="new-features-6" class="level3">
<h3 class="anchored" data-anchor-id="new-features-6">New features</h3>
<ul>
<li>Refactored the codebase to support distributional models (#607)</li>
<li>Added a default method to handle posterior predictive sampling for custom families (#625)</li>
<li><code>plot_cap()</code> gains a new argument <code>target</code> that allows to plot different parameters of the response distribution (#627)</li>
</ul>
</section>
<section id="maintenance-and-fixes-6" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-6">Maintenance and fixes</h3>
<ul>
<li>Moved the <code>tests</code> directory to the root of the repository (#607)</li>
<li>Don’t pass <code>dims</code> to the response of the likelihood distribution anymore (#629)</li>
<li>Remove requirements.txt and replace with <code>pyproject.toml</code> config file to distribute the package (#631)</li>
</ul>
</section>
<section id="documentation-6" class="level3">
<h3 class="anchored" data-anchor-id="documentation-6">Documentation</h3>
<ul>
<li>Update examples to work with the new internals (#607)</li>
<li>Fixed figure in the Sleepstudy example (#607)</li>
<li>Add example using distributional models (#641)</li>
</ul>
</section>
<section id="deprecation-6" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-6">Deprecation</h3>
<ul>
<li>Removed versioned documentation webpage (#616)</li>
<li>Removed correlated priors for group-specific terms (#607)</li>
<li>Dictionary with tuple keys are not allowed for priors anymore (#607)</li>
</ul>
</section>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">0.9.3</h2>
<section id="maintenance-and-fixes-7" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-7">Maintenance and fixes</h3>
<ul>
<li>Update to PyMC &gt;= 5, which means we use PyTensor instead of Aesara now (#613, #614)</li>
</ul>
</section>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">0.9.2</h2>
<section id="new-features-7" class="level3">
<h3 class="anchored" data-anchor-id="new-features-7">New features</h3>
<ul>
<li>Implement <code>censored()</code> (#581)</li>
<li>Add <code>Formula</code> class (#585)</li>
<li>Add common numpy transforms to extra_namespace (#589)</li>
<li>Add <code>AsymmetricLaplace</code> family for Quantile Regression (#591)</li>
<li>Add ‘transforms’ argument to <code>plot_cap()</code> (#594)</li>
<li>Add panel covariates to <code>plot_cap()</code> and make it more flexible (#596)</li>
</ul>
</section>
<section id="maintenance-and-fixes-8" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-8">Maintenance and fixes</h3>
<ul>
<li>Reimplemented predictions to make better usage of xarray data structures (#573)</li>
<li>Keep 0 dimensional parameters as 0 dimensional instead of 1 dimensional (#575)</li>
<li>Refactor terms for modularity and extensibility (#582)</li>
<li>Remove seed argument from <code>model.initial_point()</code> (#592)</li>
<li>Add build check function on prior predictive and plot prior (#605)</li>
</ul>
</section>
<section id="documentation-7" class="level3">
<h3 class="anchored" data-anchor-id="documentation-7">Documentation</h3>
<ul>
<li>Add quantile regression example (#608)</li>
</ul>
</section>
<section id="deprecation-7" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-7">Deprecation</h3>
<ul>
<li>Remove <code>automatic_priors</code> argument from <code>Model</code> (#603)</li>
<li>Remove string option for data input in <code>Model</code> (#604)</li>
</ul>
</section>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8">0.9.1</h2>
<section id="new-features-8" class="level3">
<h3 class="anchored" data-anchor-id="new-features-8">New features</h3>
<ul>
<li>Add support for jax sampling via numpyro and blackjax samplers (#526)</li>
<li>Add Laplace family (#524)</li>
<li>Improve Laplace computation and integration (#555 and #563)</li>
</ul>
</section>
<section id="maintenance-and-fixes-9" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-9">Maintenance and fixes</h3>
<ul>
<li>Ensure order variable is preserved when ploting priors (#529)</li>
<li>Treat offset accordingly (#534)</li>
<li>Refactor tests to share data generation code (#531)</li>
</ul>
</section>
<section id="documentation-8" class="level3">
<h3 class="anchored" data-anchor-id="documentation-8">Documentation</h3>
<ul>
<li>Update documentation following good inferencedata practices (#537)</li>
<li>Add logos to repo and docs (#542)</li>
</ul>
</section>
<section id="deprecation-8" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-8">Deprecation</h3>
<ul>
<li>Deprecate method argument in favor of inference_method (#554)</li>
</ul>
</section>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9">0.9.0</h2>
<section id="new-features-9" class="level3">
<h3 class="anchored" data-anchor-id="new-features-9">New features</h3>
<ul>
<li>Bambi now uses <a href="https://www.pymc.io/blog/v4_announcement.html">PyMC 4.0</a> as it’s backend. Most if not all your previous model should run the same, without the need of any change.</li>
<li>Add Plot Conditional Adjusted Predictions <code>plot_cap</code> (#517)</li>
</ul>
</section>
<section id="maintenance-and-fixes-10" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-10">Maintenance and fixes</h3>
<ul>
<li>Group specific terms now work with numeric of multiple columns (#516)</li>
</ul>
</section>
</section>
<section id="section-10" class="level2">
<h2 class="anchored" data-anchor-id="section-10">0.8.0</h2>
<section id="new-features-10" class="level3">
<h3 class="anchored" data-anchor-id="new-features-10">New features</h3>
<ul>
<li>Add VonMises (<code>"vonmises"</code>) built-in family (#453)</li>
<li><code>Model.predict()</code> gains a new argument <code>include_group_specific</code> to determine if group-specific effects are considered when making predictions (#470)</li>
<li>Add Multinomial (<code>"multinomial"</code>) built-in family (#490)</li>
</ul>
</section>
<section id="maintenance-and-fixes-11" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-11">Maintenance and fixes</h3>
<ul>
<li>Add posterior predictive sampling method to “categorical” family (#458)</li>
<li>Require Python &gt;= 3.7.2 to fix NoReturn type bug in Python (#463)</li>
<li>Fixed the wrong builtin link given by <code>link="inverse"</code> was wrong. It returned the same result as <code>link="cloglog"</code> (#472)</li>
<li>Replaced plain dictionaries with <code>namedtuple</code>s when same dictionary structure was repeated many times (#472)</li>
<li>The function <code>check_full_rank()</code> in <code>utils.py</code> now checks the array is 2 dimensional (#472)</li>
<li>Removed <code>_extract_family_prior()</code> from <code>bambi/families</code> as it was unnecesary (#472)</li>
<li>Removed <code>bambi/families/utils.py</code> as it was unnecesary (#472)</li>
<li>Removed external links and unused datasets (#483)</li>
<li>Replaced <code>"_coord_group_factor"</code> with <code>"__factor_dim"</code> and <code>"_coord_group_expr"</code> with <code>"__expr_dim"</code> in dimension/coord names (#499)</li>
<li>Fixed a bug related to modifying the types of the columns in the original data frame (#502)</li>
</ul>
</section>
<section id="documentation-9" class="level3">
<h3 class="anchored" data-anchor-id="documentation-9">Documentation</h3>
<ul>
<li>Add circular regression example (#465)</li>
<li>Add Categorical regression example (#457)</li>
<li>Add Beta regression example (#442)</li>
<li>Add Radon Example (#440)</li>
<li>Fix typos and clear up writing in some docs (#462)</li>
<li>Documented the module <code>bambi/defaults</code> (#472)</li>
<li>Improved documentation and made it more consistent (#472)</li>
<li>Cleaned Strack RRR example (#479)</li>
</ul>
</section>
<section id="deprecation-9" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-9">Deprecation</h3>
<ul>
<li>Removed old default priors (#474)</li>
<li>Removed <code>draws</code> parameter from <code>Model.predict()</code> method (#504)</li>
</ul>
</section>
</section>
<section id="section-11" class="level2">
<h2 class="anchored" data-anchor-id="section-11">0.7.1</h2>
<section id="maintenance-and-fixes-12" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-12">Maintenance and fixes</h3>
<ul>
<li>Fixed bug related to the shape of 2 level categorical group-specific effects (#441)</li>
</ul>
</section>
</section>
<section id="section-12" class="level2">
<h2 class="anchored" data-anchor-id="section-12">0.7.0</h2>
<section id="new-features-11" class="level3">
<h3 class="anchored" data-anchor-id="new-features-11">New features</h3>
<ul>
<li>Add “categorical” built-in family (#426)</li>
<li>Add <code>include_mean</code> argument to the method <code>Model.fit()</code> (#434)</li>
<li>Add <code>.set_alias()</code> method to <code>Model</code> (#435)</li>
</ul>
</section>
<section id="maintenance-and-fixes-13" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-13">Maintenance and fixes</h3>
<ul>
<li>Codebase for the PyMC backend has been refactored (#408)</li>
<li>Fix examples that averaged posterior values across chains (#429)</li>
<li>Fix issue #427 with automatic priors for the intercept term (#430)</li>
</ul>
</section>
<section id="documentation-10" class="level3">
<h3 class="anchored" data-anchor-id="documentation-10">Documentation</h3>
<ul>
<li>Add StudentT regression example, thanks to <span class="citation" data-cites="tjburch">@tjburch</span> (#414)</li>
<li>Add B-Spline regression example with cherry blossoms dataset (#416)</li>
<li>Add hirarchical linear regression example with sleepstudy dataset (#424)</li>
</ul>
</section>
</section>
<section id="section-13" class="level2">
<h2 class="anchored" data-anchor-id="section-13">0.6.3</h2>
<ul>
<li>Use formulae 0.2.0 (#411)</li>
</ul>
</section>
<section id="section-14" class="level2">
<h2 class="anchored" data-anchor-id="section-14">0.6.2</h2>
<section id="maintenance-and-fixes-14" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-14">Maintenance and fixes</h3>
<ul>
<li>Change default priors for the ‘t’ family (#403)</li>
</ul>
</section>
<section id="documentation-11" class="level3">
<h3 class="anchored" data-anchor-id="documentation-11">Documentation</h3>
<ul>
<li>Add installation instructions with conda (#406)</li>
<li>Corrected a typo: pary_id -&gt; party_id (#402)</li>
<li>Add donation information (#409)</li>
</ul>
</section>
</section>
<section id="section-15" class="level2">
<h2 class="anchored" data-anchor-id="section-15">0.6.1</h2>
<section id="maintenance-and-fixes-15" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-15">Maintenance and fixes</h3>
<ul>
<li>Documentation for all versions is built from scratch when there’s a release. This ensures older versions link to the current stable release. (#396)</li>
<li>Add new axis to prior predictive samples to represent 1 chain in the InferenceData object we return (#397)</li>
<li>Move Family, Likelihood and Link to the families submodule and improved some docstrings (#399)</li>
</ul>
</section>
<section id="documentation-12" class="level3">
<h3 class="anchored" data-anchor-id="documentation-12">Documentation</h3>
<ul>
<li>Add example with hierarchical binomial model (#398)</li>
</ul>
</section>
</section>
<section id="section-16" class="level2">
<h2 class="anchored" data-anchor-id="section-16">0.6.0</h2>
<section id="new-features-12" class="level3">
<h3 class="anchored" data-anchor-id="new-features-12">New features</h3>
<ul>
<li>Add alternative default priors (#360)</li>
<li>Add StudentT family (#367)</li>
<li>Add Beta family (#368)</li>
<li>Implement both in-sample and out-of-sample model predictions (#372)</li>
<li>Add function to load datasets (#375)</li>
<li>Add option to specify potentials (#379)</li>
<li>Add Binomial family (#386)</li>
</ul>
</section>
<section id="maintenance-and-fixes-16" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-16">Maintenance and fixes</h3>
<ul>
<li>Automatic switch initialization method from “jitter-adapt_diag” to “adapt_diag” when sampling fails (#383)</li>
<li>Predictors are internally centered when there is an intercept. This generally results in improved sampling efficiency (#385)</li>
<li>Improve documentation and error message in <code>Model.graph()</code> (#390)</li>
</ul>
</section>
<section id="documentation-13" class="level3">
<h3 class="anchored" data-anchor-id="documentation-13">Documentation</h3>
<ul>
<li>Add Negative Binomial family example notebook (#346)</li>
<li>Fixed typos and improved many notebooks (#374, #377, #382)</li>
</ul>
</section>
</section>
<section id="section-17" class="level2">
<h2 class="anchored" data-anchor-id="section-17">0.5.0</h2>
<section id="new-features-13" class="level3">
<h3 class="anchored" data-anchor-id="new-features-13">New features</h3>
<ul>
<li>It is possible to specify priors for parameters in the response distribution (#335)</li>
<li>Add probit and cloglog link functions (#340)</li>
</ul>
</section>
<section id="maintenance-and-fixes-17" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-17">Maintenance and fixes</h3>
<ul>
<li>Informative message when default priors fail because of perfect separation. Model can be fit with custom priors (#330)</li>
<li>Breaking changes to the API. All the information related to the model goes in <code>Model()</code> instantiation now (#333)</li>
<li>Fix gamma family (#337)</li>
<li>Non-default links are properly passed to statsmodels (#337)</li>
<li>Fix Wald family (#340)</li>
<li>Fix Negative binomial family (#340)</li>
<li>Add informative message when link function is not available for a given family (#340)</li>
<li>Update formulae version to 0.0.10 (#348)</li>
</ul>
</section>
<section id="documentation-14" class="level3">
<h3 class="anchored" data-anchor-id="documentation-14">Documentation</h3>
<ul>
<li>Notebooks are updated to the new API (#336)</li>
<li>Add badges, update introduction and minor style changes in webpage (#344)</li>
<li>Add example using Gamma and Wald families (#345)</li>
<li>Webpage theme has been updated to PyData theme (#347)</li>
<li>Add model evaluation to logistic regression example (#350)</li>
</ul>
</section>
</section>
<section id="section-18" class="level2">
<h2 class="anchored" data-anchor-id="section-18">0.4.1</h2>
<section id="new-features-14" class="level3">
<h3 class="anchored" data-anchor-id="new-features-14">New features</h3>
<ul>
<li>Add option to save a figure from model.graph() by passing the name of a file. Figure format and resolution can also be set (#317)</li>
<li>Objects of class Prior, Family and Model have nicer print methods (#326)</li>
</ul>
</section>
<section id="maintenance-and-fixes-18" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-18">Maintenance and fixes</h3>
<ul>
<li>Add negative binomial family to config file, which was missing (#324)</li>
<li>Add test to check model compilation with families available (#327)</li>
<li>Update formulae to version 0.0.9 (#329)</li>
</ul>
</section>
<section id="documentation-15" class="level3">
<h3 class="anchored" data-anchor-id="documentation-15">Documentation</h3>
<ul>
<li>Fix gamma docstring (#328)</li>
</ul>
</section>
</section>
<section id="section-19" class="level2">
<h2 class="anchored" data-anchor-id="section-19">0.4.0</h2>
<section id="new-features-15" class="level3">
<h3 class="anchored" data-anchor-id="new-features-15">New features</h3>
<ul>
<li>Use formulae to parse model formulas (#299)</li>
<li>Add model representation (#300)</li>
</ul>
</section>
<section id="maintenance-and-fixes-19" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-19">Maintenance and fixes</h3>
<ul>
<li>Remove deprecation warning related to pm.sample returning idata (#295)</li>
</ul>
</section>
<section id="documentation-16" class="level3">
<h3 class="anchored" data-anchor-id="documentation-16">Documentation</h3>
<ul>
<li>Add citation to Bambi preprint (#290)</li>
<li>Remove reference to pystan (#292)</li>
</ul>
</section>
</section>
<section id="section-20" class="level2">
<h2 class="anchored" data-anchor-id="section-20">0.3.0</h2>
<section id="new-features-16" class="level3">
<h3 class="anchored" data-anchor-id="new-features-16">New features</h3>
<ul>
<li>Add posterior predictive sampling (#250)</li>
<li>Add prior predictive sampling (#244)</li>
<li>Add gamma, negativebinomial and wald families (#207)</li>
</ul>
</section>
<section id="maintenance-and-fixes-20" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-20">Maintenance and fixes</h3>
<ul>
<li>Use pm.sample_prior_predictive function to sample and plot from prior (#238)</li>
<li>Fix FutureWarning: Support for multi-dimensional indexing (#242)</li>
<li>Use last version of black (#245)</li>
<li>fix broken link increase Python version (#227)</li>
<li>Add black style check on lint (#220)</li>
<li>Some linting while re-reading library (#219)</li>
<li>Remove future warning when converting the trace to InferenceData (#213)</li>
<li>Include missing files for sdist (#204)</li>
<li>Fixed if-else comparison that prevented HalfTStudent prior from being used (#205)</li>
<li>Sidestep plotting flat priors in <code>plot_priors()</code> (#258)</li>
<li>GLM.fit_constrained in automatic priors now uses start_params = None (#265)</li>
<li>Categorical <code>Term</code> within <code>Model</code> now have <code>Term.categorical</code> equal to <code>True</code>(#269)</li>
<li>Use logging instead of warnings (#270)</li>
<li>Omits ploting group-level effects and offset variables (#276)</li>
<li>Logistic regression works with no explicit index (#277)</li>
<li>Add argument to optionally keep offsets in InferenceData (#288)</li>
<li>Add argument to optionally keep group level effects and offsets variables in <code>plot_prior</code> (#288)</li>
</ul>
</section>
<section id="documentation-17" class="level3">
<h3 class="anchored" data-anchor-id="documentation-17">Documentation</h3>
<ul>
<li>Update example notebooks (#232)</li>
<li>add missing notebooks (#229)</li>
<li>Fix notebooks (#222)</li>
<li>Clean docs (#200)</li>
<li>Added notebook using Bambi and ArviZ for model comparison (#267)</li>
<li>Use same color palette in all notebooks (#282)</li>
<li>Fix divergences in examples (two divergences remaining in Strack RRR example) (#282)</li>
</ul>
</section>
<section id="deprecation-10" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-10">Deprecation</h3>
<ul>
<li>Drop support python 3.6 (#218)</li>
<li>Remove stan backend and replace sd with sigma (#205)</li>
<li>Deprecate samples argument in favor of draws (#247)</li>
</ul>
</section>
</section>
<section id="the-first-python-3-and-arviz-bambino" class="level2">
<h2 class="anchored" data-anchor-id="the-first-python-3-and-arviz-bambino">0.2.0 The First Python 3 (and ArviZ) Bambino</h2>
<section id="new-features-17" class="level3">
<h3 class="anchored" data-anchor-id="new-features-17">New features</h3>
<ul>
<li>Add laplace approximation (#184) (only for educational use, do not use for real problems)</li>
<li>Use arviz (#182, #178, #166, #159)</li>
</ul>
</section>
<section id="maintenance-and-fixes-21" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-21">Maintenance and fixes</h3>
<ul>
<li>Update requirements (#191)</li>
<li>Change default sd prior and update docs (#189)</li>
<li>Add f-strings and support python 3.6+ (#188)</li>
<li>Fix parallel sampling (#186)</li>
<li>Lint code (#175, #173, #171, #167)</li>
<li>Move coverage configuration to setup.cfg (#168)</li>
<li>Add long description to setup.py; light linting on setup.py (#162)</li>
<li>Black list external/ and tests/from pylint</li>
</ul>
</section>
<section id="documentation-18" class="level3">
<h3 class="anchored" data-anchor-id="documentation-18">Documentation</h3>
<ul>
<li>Add missing example (#194)</li>
<li>Update docs and fix typos (#185, #181)</li>
<li>Add missing items to readme and code of conduct (#180)</li>
<li>Simplify readme (#179)</li>
<li>Unify docstring style and remove not used code (#169)</li>
</ul>
</section>
<section id="deprecation-11" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-11">Deprecation</h3>
<ul>
<li>Deprecate Stan backend (#183)</li>
</ul>
</section>
</section>
<section id="the-last-legacy-python-bambino" class="level2">
<h2 class="anchored" data-anchor-id="the-last-legacy-python-bambino">0.1.5 (The last legacy Python Bambino)</h2>
<section id="new-features-18" class="level3">
<h3 class="anchored" data-anchor-id="new-features-18">New features</h3>
<ul>
<li>Use a callable as link function (#147)</li>
</ul>
</section>
<section id="maintenance-and-fixes-22" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-and-fixes-22">Maintenance and fixes</h3>
<ul>
<li>Update to Python 3, black and some pylint (#158)</li>
<li>Fix test warnings (#144)</li>
<li>Reorder requirements; Add matplotlib to requirements.txt (#143)</li>
<li>Reorder imports; Only import necessary submodules from statsmodels (#142)</li>
<li>Update travis config (#135)</li>
</ul>
</section>
<section id="documentation-19" class="level3">
<h3 class="anchored" data-anchor-id="documentation-19">Documentation</h3>
<ul>
<li>Add contributing guide (#146)</li>
<li>Update notebooks (#140)</li>
</ul>
</section>
<section id="deprecation-12" class="level3">
<h3 class="anchored" data-anchor-id="deprecation-12">Deprecation</h3>
<ul>
<li>Last version to support Python 2.7</li>
</ul>
</section>
</section>
<section id="december-11" class="level2">
<h2 class="anchored" data-anchor-id="december-11">0.1.1 (2017 December 11)</h2>
<ul>
<li>Minor release for bugfixes and minor improvements. Changes include:</li>
<li>Bug that was causing an incorrect link function to be used in the PyMC3 backend when fitting logistic models.</li>
<li>Fixed handling of missing values in categorical variables.</li>
<li>Fixed bug in set_priors() when passing numerical values for scale.</li>
<li>Improved internal handling of custom priors.</li>
<li>Preliminary Sphinx docs (WIP; thanks to <span class="citation" data-cites="ejolly">@ejolly</span>).</li>
</ul>
</section>
<section id="march-31" class="level2">
<h2 class="anchored" data-anchor-id="march-31">0.1.0 (2017 March 31)</h2>
<p>This is a major release that introduces several new features, significant API changes, and a large number of bug fixes and minor improvements. Notable changes include:</p>
<ul>
<li>Support for Stan as the sampling back-end (in addition to PyMC3), via the PyStan package.</li>
<li>Dropped support for the <code>add_term</code> API; all model specification is now done via formulas.</li>
<li>Expanded support for arbitrary random effects specifications; any formula now supported by patsy can be passed in as the left-hand side of a random effects specification (e.g., previously, ‘(a*b)|c’ would not have worked).</li>
<li>Completely refactored <code>Results</code> classes that no longer depend on PyMC3, providing a completely generic representation of sampler results, independent of any back-end.</li>
<li>Refactored plotting and summary methods implemented on the abstract MCMCResults classes rather than at the back-end level.</li>
<li><em>Much</em> better compilation and sampling performance for models that include random effects with many levels. In many cases, performance should now be comparable to the most efficient native implementations of the models in the respective back-ends.</li>
<li>All random effects priors now use the “non-centered” parameterization by default, significantly reducing bias for some models.</li>
<li>Improved naming conventions that are more consistent with other packages (e.g., random effects now include the ‘|’ operator in term names).</li>
<li>Refactored <code>Term</code> class, including a separate subclass for <code>RandomTerm</code>s, and a number of other associated changes to the internal object model.</li>
<li>Updated documentation and notebooks, including two new notebooks featuring well-developed examples (datasets included).</li>
<li>Improved handling of NA values in continuous columns.</li>
<li>Support for flat priors everywhere (by setting <code>auto_scale=False</code>).</li>
<li>Numerous bug fixes and minor improvements</li>
</ul>
</section>
<section id="january-17" class="level2">
<h2 class="anchored" data-anchor-id="january-17">0.0.5 (2017 January 17)</h2>
<ul>
<li>Weakly informative default priors now work the same for all response families &amp; link functions</li>
<li>Minor bug fixes/tweaks</li>
</ul>
</section>
<section id="october-11" class="level2">
<h2 class="anchored" data-anchor-id="october-11">0.0.4 (2016 October 11)</h2>
<ul>
<li>Fixes referencing of Theano ops after PyMC3 namespace clean-up</li>
<li>Added example Jupyter notebooks</li>
<li>Improved handling of priors</li>
<li>Improved prior plots and result summaries</li>
<li>Improved access to MCMC trace results</li>
<li>Add handling for datasets with NaN values</li>
<li>Added travis-ci and coveralls support</li>
<li>Minor bug fixes/tweaks</li>
</ul>
</section>
<section id="september-4" class="level2">
<h2 class="anchored" data-anchor-id="september-4">0.0.3 (2016 September 4)</h2>
<p>First official release.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© Copyright 2025, The developers of Bambi.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>